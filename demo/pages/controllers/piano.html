<div class="row demo">
    <div class="col-sm-12 description">
        <div class="col-sm-6">
            <h1>Piano</h1>
            This component was introduced for the purpose of testing the instruments created using flocking framework.
            So,
            the
            instrument created using the flocking shall be passed as parameter to the component. Also the primary color,
            starting
            note and the length of the piano also can be modified through parameters.
            <br/>
            <br/>
            This component is fully responsive and developed using an SVG. Also this is also accessible via the
            keyboard.
            So, the active area which can be controlled by the keyboard is highlighted in the piano. And the highlighted
            area
            can be moved to left and right using arrow keys.
            <br/>
            <br/>
            <button class="btn fn-btn">Read more</button>
            <button class="btn fn-btn">Try..</button>
        </div>
        <div class="col-sm-6">
            <div class="col-xs-12 test" style="height: 100%"></div>
        </div>
    </div>
    <div class="col-sm-12 try-example" style="min-height: 300px; height: 300px">
        <div class="col-xs-6" style="min-height: 300px">
            <div id="editor" class="col-sm-12" style="min-height: 300px">
sisiliano.piano($('#preview'), {
    model: {
        color: "#FF0000"
    },
    listeners: {
        onKeyPress: function (key, frequency) {
            playKey(key, frequency);
        },
        onKeyRelease: function (key) {
            releaseKey(key);
        }
    }
});
            </div>
            <div class="btn play-btn glyphicon glyphicon-play">
            </div>
        </div>
        <div class="col-xs-6 preview" id="preview" style="min-height: 300px;">
        </div>
    </div>
    <script>
        var tds = $('.test');
        var colors = [
            "#F44336",
            "#E91E63",
            "#009688",
            "#4CAF50",
            "#CDDC39",
            "#673AB7",
            "#3F51B5",
            "#FFEB3B",
            "#FF9800"
        ];
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        var context = new window.AudioContext();
        var nodes = {};
        if (context) {
            var masterGain = context.createGain();
            masterGain.gain.value = 0.3;
            masterGain.connect(context.destination);
        }

        var playKey = function (index, frequency) {
            var oscillator = context.createOscillator();
            oscillator.type = "square";
            oscillator.frequency.value = frequency;
            oscillator.connect(masterGain);
            oscillator.start(0);
            nodes[index] = oscillator;
        };

        var releaseKey = function (index) {
            var node = nodes[index];
            if (node) {
                node.stop(0);
                node.disconnect();
                nodes[index] = null;
            }
        };

        var tds = $('.test');
        var colors = ['#FF0000', 'blue', 'yellow', 'red', 'orange', 'blue'];
        for (var i = 0; i < tds.length; i++) {
            sisiliano.piano($(tds[i]), {
                listeners: {
                    onKeyPress: function (key, frequency) {
                        playKey(key, frequency);
                    },
                    onKeyRelease: function (key) {
                        releaseKey(key);
                    }
                }
            });
        }

        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.getSession().setMode("ace/mode/javascript");

        $(".play-btn").on("load click", function (evt) {
            $("#preview").empty();
            $("#preview").html("<div class='col-lg-12 text-center'><i class='loading-animation fa-li fa fa-spinner fa-spin'></i></div>");
            eval(editor.getValue());
        });
        $(".play-btn").draggable({containment: "parent"});
        $(".play-btn").trigger("click");
    </script>
</div>